Index: .idea/misc.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<project version=\"4\">\r\n  <component name=\"JavaScriptSettings\">\r\n    <option name=\"languageLevel\" value=\"ES6\" />\r\n  </component>\r\n  <component name=\"MavenProjectsManager\">\r\n    <option name=\"originalFiles\">\r\n      <list>\r\n        <option value=\"$PROJECT_DIR$/pom.xml\" />\r\n      </list>\r\n    </option>\r\n  </component>\r\n  <component name=\"ProjectRootManager\" version=\"2\" languageLevel=\"JDK_11\" project-jdk-name=\"11\" project-jdk-type=\"JavaSDK\" />\r\n</project>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- .idea/misc.xml	(revision ac973f4ad6b6f8d8629ede07b943e524aeb1864e)
+++ .idea/misc.xml	(date 1607418681135)
@@ -10,5 +10,5 @@
       </list>
     </option>
   </component>
-  <component name="ProjectRootManager" version="2" languageLevel="JDK_11" project-jdk-name="11" project-jdk-type="JavaSDK" />
+  <component name="ProjectRootManager" version="2" languageLevel="JDK_11" default="false" project-jdk-name="11" project-jdk-type="JavaSDK" />
 </project>
\ No newline at end of file
Index: .idea/chat-master.iml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<module org.jetbrains.idea.maven.project.MavenProjectsManager.isMavenModule=\"true\" type=\"JAVA_MODULE\" version=\"4\">\r\n  <component name=\"FacetManager\">\r\n    <facet type=\"Spring\" name=\"Spring\">\r\n      <configuration />\r\n    </facet>\r\n    <facet type=\"web\" name=\"Web\">\r\n      <configuration>\r\n        <webroots />\r\n        <sourceRoots>\r\n          <root url=\"file://$MODULE_DIR$/src/main/java\" />\r\n          <root url=\"file://$MODULE_DIR$/src/main/resources\" />\r\n        </sourceRoots>\r\n      </configuration>\r\n    </facet>\r\n    <facet type=\"jpa\" name=\"JPA\">\r\n      <configuration>\r\n        <setting name=\"validation-enabled\" value=\"true\" />\r\n        <datasource-mapping>\r\n          <factory-entry name=\"chat-master\" />\r\n        </datasource-mapping>\r\n        <naming-strategy-map />\r\n      </configuration>\r\n    </facet>\r\n  </component>\r\n  <component name=\"NewModuleRootManager\" LANGUAGE_LEVEL=\"JDK_1_8\">\r\n    <output url=\"file://$MODULE_DIR$/target/classes\" />\r\n    <output-test url=\"file://$MODULE_DIR$/target/test-classes\" />\r\n    <content url=\"file://$MODULE_DIR$\">\r\n      <sourceFolder url=\"file://$MODULE_DIR$/src/main/java\" isTestSource=\"false\" />\r\n      <sourceFolder url=\"file://$MODULE_DIR$/src/main/resources\" type=\"java-resource\" />\r\n      <sourceFolder url=\"file://$MODULE_DIR$/src/test/java\" isTestSource=\"true\" />\r\n      <excludeFolder url=\"file://$MODULE_DIR$/target\" />\r\n    </content>\r\n    <orderEntry type=\"inheritedJdk\" />\r\n    <orderEntry type=\"sourceFolder\" forTests=\"false\" />\r\n    <orderEntry type=\"library\" name=\"Maven: org.springframework.boot:spring-boot-starter-web:2.3.1.RELEASE\" level=\"project\" />\r\n    <orderEntry type=\"library\" name=\"Maven: org.springframework.boot:spring-boot-starter:2.3.1.RELEASE\" level=\"project\" />\r\n    <orderEntry type=\"library\" name=\"Maven: org.springframework.boot:spring-boot:2.3.1.RELEASE\" level=\"project\" />\r\n    <orderEntry type=\"library\" name=\"Maven: org.springframework.boot:spring-boot-autoconfigure:2.3.1.RELEASE\" level=\"project\" />\r\n    <orderEntry type=\"library\" name=\"Maven: org.springframework.boot:spring-boot-starter-logging:2.3.1.RELEASE\" level=\"project\" />\r\n    <orderEntry type=\"library\" name=\"Maven: ch.qos.logback:logback-classic:1.2.3\" level=\"project\" />\r\n    <orderEntry type=\"library\" name=\"Maven: ch.qos.logback:logback-core:1.2.3\" level=\"project\" />\r\n    <orderEntry type=\"library\" name=\"Maven: org.apache.logging.log4j:log4j-to-slf4j:2.13.3\" level=\"project\" />\r\n    <orderEntry type=\"library\" name=\"Maven: org.apache.logging.log4j:log4j-api:2.13.3\" level=\"project\" />\r\n    <orderEntry type=\"library\" name=\"Maven: org.slf4j:jul-to-slf4j:1.7.30\" level=\"project\" />\r\n    <orderEntry type=\"library\" name=\"Maven: jakarta.annotation:jakarta.annotation-api:1.3.5\" level=\"project\" />\r\n    <orderEntry type=\"library\" name=\"Maven: org.yaml:snakeyaml:1.26\" level=\"project\" />\r\n    <orderEntry type=\"library\" name=\"Maven: org.springframework.boot:spring-boot-starter-json:2.3.1.RELEASE\" level=\"project\" />\r\n    <orderEntry type=\"library\" name=\"Maven: com.fasterxml.jackson.core:jackson-databind:2.11.0\" level=\"project\" />\r\n    <orderEntry type=\"library\" name=\"Maven: com.fasterxml.jackson.core:jackson-core:2.11.0\" level=\"project\" />\r\n    <orderEntry type=\"library\" name=\"Maven: com.fasterxml.jackson.datatype:jackson-datatype-jdk8:2.11.0\" level=\"project\" />\r\n    <orderEntry type=\"library\" name=\"Maven: com.fasterxml.jackson.datatype:jackson-datatype-jsr310:2.11.0\" level=\"project\" />\r\n    <orderEntry type=\"library\" name=\"Maven: com.fasterxml.jackson.module:jackson-module-parameter-names:2.11.0\" level=\"project\" />\r\n    <orderEntry type=\"library\" name=\"Maven: org.springframework.boot:spring-boot-starter-tomcat:2.3.1.RELEASE\" level=\"project\" />\r\n    <orderEntry type=\"library\" name=\"Maven: org.apache.tomcat.embed:tomcat-embed-core:9.0.36\" level=\"project\" />\r\n    <orderEntry type=\"library\" name=\"Maven: org.glassfish:jakarta.el:3.0.3\" level=\"project\" />\r\n    <orderEntry type=\"library\" name=\"Maven: org.apache.tomcat.embed:tomcat-embed-websocket:9.0.36\" level=\"project\" />\r\n    <orderEntry type=\"library\" name=\"Maven: org.springframework:spring-web:5.2.7.RELEASE\" level=\"project\" />\r\n    <orderEntry type=\"library\" name=\"Maven: org.springframework:spring-beans:5.2.7.RELEASE\" level=\"project\" />\r\n    <orderEntry type=\"library\" name=\"Maven: org.springframework:spring-webmvc:5.2.7.RELEASE\" level=\"project\" />\r\n    <orderEntry type=\"library\" name=\"Maven: org.springframework:spring-aop:5.2.7.RELEASE\" level=\"project\" />\r\n    <orderEntry type=\"library\" name=\"Maven: org.springframework:spring-context:5.2.7.RELEASE\" level=\"project\" />\r\n    <orderEntry type=\"library\" name=\"Maven: org.springframework:spring-expression:5.2.7.RELEASE\" level=\"project\" />\r\n    <orderEntry type=\"library\" name=\"Maven: org.springframework.boot:spring-boot-starter-websocket:2.3.1.RELEASE\" level=\"project\" />\r\n    <orderEntry type=\"library\" name=\"Maven: org.springframework:spring-messaging:5.2.7.RELEASE\" level=\"project\" />\r\n    <orderEntry type=\"library\" name=\"Maven: org.springframework:spring-websocket:5.2.7.RELEASE\" level=\"project\" />\r\n    <orderEntry type=\"library\" scope=\"PROVIDED\" name=\"Maven: javax:javaee-api:7.0\" level=\"project\" />\r\n    <orderEntry type=\"library\" scope=\"PROVIDED\" name=\"Maven: com.sun.mail:javax.mail:1.5.0\" level=\"project\" />\r\n    <orderEntry type=\"library\" scope=\"PROVIDED\" name=\"Maven: javax.activation:activation:1.1\" level=\"project\" />\r\n    <orderEntry type=\"library\" name=\"Maven: cn.hutool:hutool-all:4.5.16\" level=\"project\" />\r\n    <orderEntry type=\"library\" name=\"Maven: com.alibaba:fastjson:1.2.70\" level=\"project\" />\r\n    <orderEntry type=\"library\" scope=\"TEST\" name=\"Maven: org.springframework.boot:spring-boot-starter-test:2.3.1.RELEASE\" level=\"project\" />\r\n    <orderEntry type=\"library\" scope=\"TEST\" name=\"Maven: org.springframework.boot:spring-boot-test:2.3.1.RELEASE\" level=\"project\" />\r\n    <orderEntry type=\"library\" scope=\"TEST\" name=\"Maven: org.springframework.boot:spring-boot-test-autoconfigure:2.3.1.RELEASE\" level=\"project\" />\r\n    <orderEntry type=\"library\" scope=\"TEST\" name=\"Maven: com.jayway.jsonpath:json-path:2.4.0\" level=\"project\" />\r\n    <orderEntry type=\"library\" scope=\"TEST\" name=\"Maven: net.minidev:json-smart:2.3\" level=\"project\" />\r\n    <orderEntry type=\"library\" scope=\"TEST\" name=\"Maven: net.minidev:accessors-smart:1.2\" level=\"project\" />\r\n    <orderEntry type=\"library\" scope=\"TEST\" name=\"Maven: org.ow2.asm:asm:5.0.4\" level=\"project\" />\r\n    <orderEntry type=\"library\" scope=\"TEST\" name=\"Maven: jakarta.xml.bind:jakarta.xml.bind-api:2.3.3\" level=\"project\" />\r\n    <orderEntry type=\"library\" scope=\"TEST\" name=\"Maven: jakarta.activation:jakarta.activation-api:1.2.2\" level=\"project\" />\r\n    <orderEntry type=\"library\" scope=\"TEST\" name=\"Maven: org.assertj:assertj-core:3.16.1\" level=\"project\" />\r\n    <orderEntry type=\"library\" name=\"Maven: org.hamcrest:hamcrest:2.2\" level=\"project\" />\r\n    <orderEntry type=\"library\" scope=\"TEST\" name=\"Maven: org.junit.jupiter:junit-jupiter:5.6.2\" level=\"project\" />\r\n    <orderEntry type=\"library\" scope=\"TEST\" name=\"Maven: org.junit.jupiter:junit-jupiter-api:5.6.2\" level=\"project\" />\r\n    <orderEntry type=\"library\" scope=\"TEST\" name=\"Maven: org.apiguardian:apiguardian-api:1.1.0\" level=\"project\" />\r\n    <orderEntry type=\"library\" scope=\"TEST\" name=\"Maven: org.opentest4j:opentest4j:1.2.0\" level=\"project\" />\r\n    <orderEntry type=\"library\" scope=\"TEST\" name=\"Maven: org.junit.platform:junit-platform-commons:1.6.2\" level=\"project\" />\r\n    <orderEntry type=\"library\" scope=\"TEST\" name=\"Maven: org.junit.jupiter:junit-jupiter-params:5.6.2\" level=\"project\" />\r\n    <orderEntry type=\"library\" scope=\"TEST\" name=\"Maven: org.junit.jupiter:junit-jupiter-engine:5.6.2\" level=\"project\" />\r\n    <orderEntry type=\"library\" scope=\"TEST\" name=\"Maven: org.junit.platform:junit-platform-engine:1.6.2\" level=\"project\" />\r\n    <orderEntry type=\"library\" scope=\"TEST\" name=\"Maven: org.mockito:mockito-core:3.3.3\" level=\"project\" />\r\n    <orderEntry type=\"library\" name=\"Maven: net.bytebuddy:byte-buddy:1.10.11\" level=\"project\" />\r\n    <orderEntry type=\"library\" scope=\"TEST\" name=\"Maven: net.bytebuddy:byte-buddy-agent:1.10.11\" level=\"project\" />\r\n    <orderEntry type=\"library\" scope=\"TEST\" name=\"Maven: org.objenesis:objenesis:2.6\" level=\"project\" />\r\n    <orderEntry type=\"library\" scope=\"TEST\" name=\"Maven: org.mockito:mockito-junit-jupiter:3.3.3\" level=\"project\" />\r\n    <orderEntry type=\"library\" scope=\"TEST\" name=\"Maven: org.skyscreamer:jsonassert:1.5.0\" level=\"project\" />\r\n    <orderEntry type=\"library\" scope=\"TEST\" name=\"Maven: com.vaadin.external.google:android-json:0.0.20131108.vaadin1\" level=\"project\" />\r\n    <orderEntry type=\"library\" name=\"Maven: org.springframework:spring-core:5.2.7.RELEASE\" level=\"project\" />\r\n    <orderEntry type=\"library\" name=\"Maven: org.springframework:spring-jcl:5.2.7.RELEASE\" level=\"project\" />\r\n    <orderEntry type=\"library\" scope=\"TEST\" name=\"Maven: org.springframework:spring-test:5.2.7.RELEASE\" level=\"project\" />\r\n    <orderEntry type=\"library\" scope=\"TEST\" name=\"Maven: org.xmlunit:xmlunit-core:2.7.0\" level=\"project\" />\r\n    <orderEntry type=\"library\" name=\"Maven: junit:junit:4.13\" level=\"project\" />\r\n    <orderEntry type=\"library\" name=\"Maven: org.hamcrest:hamcrest-core:2.2\" level=\"project\" />\r\n    <orderEntry type=\"library\" name=\"Maven: io.springfox:springfox-swagger2:2.9.2\" level=\"project\" />\r\n    <orderEntry type=\"library\" name=\"Maven: io.swagger:swagger-annotations:1.5.20\" level=\"project\" />\r\n    <orderEntry type=\"library\" name=\"Maven: io.swagger:swagger-models:1.5.20\" level=\"project\" />\r\n    <orderEntry type=\"library\" name=\"Maven: com.fasterxml.jackson.core:jackson-annotations:2.11.0\" level=\"project\" />\r\n    <orderEntry type=\"library\" name=\"Maven: io.springfox:springfox-spi:2.9.2\" level=\"project\" />\r\n    <orderEntry type=\"library\" name=\"Maven: io.springfox:springfox-core:2.9.2\" level=\"project\" />\r\n    <orderEntry type=\"library\" name=\"Maven: io.springfox:springfox-schema:2.9.2\" level=\"project\" />\r\n    <orderEntry type=\"library\" name=\"Maven: io.springfox:springfox-swagger-common:2.9.2\" level=\"project\" />\r\n    <orderEntry type=\"library\" name=\"Maven: io.springfox:springfox-spring-web:2.9.2\" level=\"project\" />\r\n    <orderEntry type=\"library\" name=\"Maven: com.google.guava:guava:20.0\" level=\"project\" />\r\n    <orderEntry type=\"library\" name=\"Maven: com.fasterxml:classmate:1.5.1\" level=\"project\" />\r\n    <orderEntry type=\"library\" name=\"Maven: org.slf4j:slf4j-api:1.7.30\" level=\"project\" />\r\n    <orderEntry type=\"library\" name=\"Maven: org.springframework.plugin:spring-plugin-core:1.2.0.RELEASE\" level=\"project\" />\r\n    <orderEntry type=\"library\" name=\"Maven: org.springframework.plugin:spring-plugin-metadata:1.2.0.RELEASE\" level=\"project\" />\r\n    <orderEntry type=\"library\" name=\"Maven: org.mapstruct:mapstruct:1.2.0.Final\" level=\"project\" />\r\n    <orderEntry type=\"library\" name=\"Maven: io.springfox:springfox-swagger-ui:2.9.2\" level=\"project\" />\r\n  </component>\r\n</module>
===================================================================
--- .idea/chat-master.iml	(revision ac973f4ad6b6f8d8629ede07b943e524aeb1864e)
+++ .idea/kk.iml	(date 1607432054861)
@@ -18,6 +18,7 @@
         <setting name="validation-enabled" value="true" />
         <datasource-mapping>
           <factory-entry name="chat-master" />
+          <factory-entry name="kk" />
         </datasource-mapping>
         <naming-strategy-map />
       </configuration>
@@ -32,7 +33,7 @@
       <sourceFolder url="file://$MODULE_DIR$/src/test/java" isTestSource="true" />
       <excludeFolder url="file://$MODULE_DIR$/target" />
     </content>
-    <orderEntry type="inheritedJdk" />
+    <orderEntry type="jdk" jdkName="11" jdkType="JavaSDK" />
     <orderEntry type="sourceFolder" forTests="false" />
     <orderEntry type="library" name="Maven: org.springframework.boot:spring-boot-starter-web:2.3.1.RELEASE" level="project" />
     <orderEntry type="library" name="Maven: org.springframework.boot:spring-boot-starter:2.3.1.RELEASE" level="project" />
Index: .idea/modules.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<project version=\"4\">\r\n  <component name=\"ProjectModuleManager\">\r\n    <modules>\r\n      <module fileurl=\"file://$PROJECT_DIR$/.idea/chat-master.iml\" filepath=\"$PROJECT_DIR$/.idea/chat-master.iml\" />\r\n    </modules>\r\n  </component>\r\n</project>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- .idea/modules.xml	(revision ac973f4ad6b6f8d8629ede07b943e524aeb1864e)
+++ .idea/modules.xml	(date 1607418551843)
@@ -2,7 +2,7 @@
 <project version="4">
   <component name="ProjectModuleManager">
     <modules>
-      <module fileurl="file://$PROJECT_DIR$/.idea/chat-master.iml" filepath="$PROJECT_DIR$/.idea/chat-master.iml" />
+      <module fileurl="file://$PROJECT_DIR$/.idea/kk.iml" filepath="$PROJECT_DIR$/.idea/kk.iml" />
     </modules>
   </component>
 </project>
\ No newline at end of file
Index: src/main/java/net/kk/chat/websocket/ApplicationWebSocket.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package net.kk.chat.websocket;\r\n\r\nimport com.alibaba.fastjson.JSON;\r\nimport com.fasterxml.jackson.databind.ObjectMapper;\r\nimport net.kk.chat.utils.MessageUtil;\r\nimport org.springframework.stereotype.Component;\r\n\r\n\r\nimport javax.websocket.*;\r\nimport javax.websocket.server.ServerEndpoint;\r\nimport java.io.IOException;\r\nimport java.lang.reflect.Method;\r\nimport java.util.*;\r\nimport java.util.concurrent.ConcurrentHashMap;\r\nimport java.util.concurrent.atomic.AtomicInteger;\r\nimport net.kk.chat.entity.Message;\r\n\r\n/**\r\n * @author KK\r\n */\r\n@ServerEndpoint(value = \"/websocket\")\r\n@Component\r\npublic class ApplicationWebSocket {\r\n    private static final AtomicInteger onlineCount = new AtomicInteger(0);\r\n    private static final Map<String, ApplicationWebSocket> webSocket = new ConcurrentHashMap<>(); //存储在线人数\r\n    private Session session;\r\n    private String sendName;\r\n\r\n    @OnOpen\r\n    public void onOpen(Session session) {\r\n        addOnlineCount();           //在线数加1\r\n        System.out.println(\"有新连接加入！当前在线人数为\" + getOnlineCount());\r\n        this.session = session;\r\n        //重新把聊天列表推送给客户端\r\n        sendMessNames();\r\n    }\r\n\r\n    @OnMessage\r\n    public void onMessage(String text) {\r\n        try {\r\n            ObjectMapper mapper = new ObjectMapper();\r\n            Message message = mapper.readValue(text, Message.class);\r\n            String type = message.getType();\r\n            Method method = this.getClass().getDeclaredMethod(type, Message.class);\r\n            method.invoke(this, message);\r\n        } catch (Exception e) {\r\n            e.printStackTrace();\r\n        }\r\n    }\r\n    @OnClose\r\n    public void onClose() {\r\n        System.out.println(sendName + \"退出了聊天室!\");\r\n        if(sendName != null){\r\n            ApplicationWebSocket.webSocket.remove(sendName);\r\n        }\r\n        subOnlineCount();\r\n        sendMessNames();\r\n    }\r\n    @OnError\r\n    public void onError(Throwable throwable){\r\n        System.out.println(\"发生错误\");\r\n        throwable.printStackTrace();\r\n    }\r\n\r\n    public Set<String> getNames() {\r\n        return webSocket.keySet();\r\n    }\r\n\r\n    public void sendMessageAll(String jsonMessage)  {\r\n        try {\r\n            Set<String> names = getNames();\r\n            for (String name : names) {\r\n                ApplicationWebSocket.webSocket.get(name).session.getBasicRemote().sendText(jsonMessage);\r\n            }\r\n        }catch (IOException e){\r\n            e.printStackTrace();\r\n        }\r\n    }\r\n\r\n    public void sendMessageAll( Message message) {\r\n        message.setText(message.getText().replaceAll(\"\\n\", \"<br>\"));\r\n        String jsonMessage = JSON.toJSONString(message);\r\n        sendMessageAll(jsonMessage);\r\n    }\r\n\r\n    public void sendMessage(Message message) throws IOException {\r\n        message.setText(message.getText().replaceAll(\"\\n\", \"<br>\"));\r\n        String jsonMessage = JSON.toJSONString(message);\r\n        ApplicationWebSocket.webSocket.get(message.getReceiveName()).session.getBasicRemote().sendText(jsonMessage);\r\n    }\r\n    public void sendRobot(Message message) throws IOException {\r\n        final String URL = \"http://api.qingyunke.com/api.php?key=free&appid=0&msg=\" + message.getText();\r\n        message.setUrl(\"dist/images/robot.png\");\r\n        String result = MessageUtil.sendGetRequest(URL);\r\n        result = result.substring(23, result.length() -2);\r\n        String toName = message.getSendName();\r\n        message.setSendName(\"机器人\");\r\n        message.setText(result);\r\n        String jsonMessage = JSON.toJSONString(message);\r\n        ApplicationWebSocket.webSocket.get(toName).session.getBasicRemote().sendText(jsonMessage);\r\n    }\r\n\r\n    public void setting(Message message) {\r\n        if(Objects.equals(null, message.getSendName())) return;\r\n        this.sendName = message.getSendName();\r\n        ApplicationWebSocket.webSocket.put(this.sendName, this);\r\n        sendMessNames();\r\n    }\r\n    public void sendMessNames(){\r\n        String json = MessageUtil.getMessNames(getNames());\r\n        sendMessageAll(json);\r\n    }\r\n    public static synchronized int getOnlineCount() {\r\n        return onlineCount.get();\r\n    }\r\n\r\n    public static synchronized void addOnlineCount() {\r\n        ApplicationWebSocket.onlineCount.getAndIncrement();\r\n    }\r\n\r\n    public static synchronized void subOnlineCount() {\r\n        ApplicationWebSocket.onlineCount.getAndDecrement();\r\n    }\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- src/main/java/net/kk/chat/websocket/ApplicationWebSocket.java	(revision ac973f4ad6b6f8d8629ede07b943e524aeb1864e)
+++ src/main/java/net/kk/chat/websocket/ApplicationWebSocket.java	(date 1607418887060)
@@ -33,6 +33,7 @@
         this.session = session;
         //重新把聊天列表推送给客户端
         sendMessNames();
+        
     }
 
     @OnMessage
Index: .idea/compiler.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<project version=\"4\">\r\n  <component name=\"CompilerConfiguration\">\r\n    <annotationProcessing>\r\n      <profile name=\"Maven default annotation processors profile\" enabled=\"true\">\r\n        <sourceOutputDir name=\"target/generated-sources/annotations\" />\r\n        <sourceTestOutputDir name=\"target/generated-test-sources/test-annotations\" />\r\n        <outputRelativeToContentRoot value=\"true\" />\r\n        <module name=\"chat-master\" />\r\n      </profile>\r\n    </annotationProcessing>\r\n    <bytecodeTargetLevel>\r\n      <module name=\"chat-master\" target=\"1.8\" />\r\n    </bytecodeTargetLevel>\r\n  </component>\r\n  <component name=\"JavacSettings\">\r\n    <option name=\"ADDITIONAL_OPTIONS_OVERRIDE\">\r\n      <module name=\"chat-master\" options=\"-parameters\" />\r\n    </option>\r\n  </component>\r\n</project>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- .idea/compiler.xml	(revision ac973f4ad6b6f8d8629ede07b943e524aeb1864e)
+++ .idea/compiler.xml	(date 1607418551728)
@@ -6,16 +6,16 @@
         <sourceOutputDir name="target/generated-sources/annotations" />
         <sourceTestOutputDir name="target/generated-test-sources/test-annotations" />
         <outputRelativeToContentRoot value="true" />
-        <module name="chat-master" />
+        <module name="kk" />
       </profile>
     </annotationProcessing>
-    <bytecodeTargetLevel>
-      <module name="chat-master" target="1.8" />
+    <bytecodeTargetLevel target="11">
+      <module name="kk" target="11" />
     </bytecodeTargetLevel>
   </component>
   <component name="JavacSettings">
     <option name="ADDITIONAL_OPTIONS_OVERRIDE">
-      <module name="chat-master" options="-parameters" />
+      <module name="kk" options="-parameters" />
     </option>
   </component>
 </project>
\ No newline at end of file
Index: src/main/resources/static/dist/js/index.js
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>class Stopwatch {\r\n    constructor() {\r\n        this.reset();\r\n    }\r\n\r\n    reset() {\r\n        let result = this.date;\r\n        this.date = new Date();\r\n        return this.date;\r\n    }\r\n\r\n    elapseTime() {\r\n        return new Date() - this.date;\r\n    }\r\n}\r\n\r\nDate.prototype.format = function (fmt) {\r\n    var o = {\r\n        \"M+\": this.getMonth() + 1, //月份\r\n        \"d+\": this.getDate(), //日\r\n        \"h+\": this.getHours(), //小时\r\n        \"m+\": this.getMinutes(), //分\r\n        \"s+\": this.getSeconds(), //秒\r\n        \"q+\": Math.floor((this.getMonth() + 3) / 3), //季度\r\n        \"S\": this.getMilliseconds() //毫秒\r\n    };\r\n    if (/(y+)/.test(fmt)) fmt = fmt.replace(RegExp.$1, (this.getFullYear() + \"\").substr(4 - RegExp.$1.length));\r\n    for (var k in o)\r\n        if (new RegExp(\"(\" + k + \")\").test(fmt)) fmt = fmt.replace(RegExp.$1, (RegExp.$1.length == 1) ? (o[k]) : ((\"00\" + o[k]).substr((\"\" + o[k]).length)));\r\n    return fmt;\r\n}\r\n\r\nconst app = new Vue({\r\n    el: '#app',\r\n    data: {\r\n        path: 'ws://127.0.0.1:8080/websocket',\r\n        socket: null,\r\n        message: [],\r\n        sendName: '',\r\n        receiveName: '',\r\n        text: '',\r\n        userCount: [],\r\n        searchVal: '',\r\n        url: '',\r\n        userListOpen: true,\r\n        time: new Stopwatch()\r\n    },\r\n    mounted() {\r\n        this.sendName = $.cookie(\"sendName\")\r\n        this.url = '/upload/' + this.sendName + \".jpg\"\r\n        this.init()\r\n    },\r\n    methods: {\r\n        init() {\r\n            if (typeof (WebSocket) === \"undefined\") {\r\n                alert(\"您的浏览器不支持socket\")\r\n            } else {\r\n                // 实例化socket\r\n                this.socket = new WebSocket(this.path)\r\n                // 监听socket连接\r\n                this.socket.onopen = this.open\r\n                // 监听socket错误信息\r\n                this.socket.onerror = this.error\r\n                // 监听socket消息\r\n                this.socket.onmessage = this.getMessage\r\n            }\r\n\r\n        },\r\n        open() {\r\n            console.log(\"socket连接成功\")\r\n            if (this.sendName != \"\") {\r\n                this.socket.send(JSON.stringify({sendName: this.sendName, type: \"setting\"}))\r\n            }\r\n        },\r\n        error() {\r\n            console.log(\"连接错误\")\r\n        },\r\n        getMessage(msg) {\r\n            let parse = JSON.parse(msg.data);\r\n            if (parse.type == \"userCount\") {\r\n                this.userCount = parse.userCount\r\n                return\r\n            } else if(parse.receiveName == \"机器人\"){\r\n                this.message.push(parse);\r\n            }else if (parse.sendName == this.receiveName && parse.receiveName != \"在线群聊\" && parse.sendName != this.sendName) {\r\n                this.message.push(parse)\r\n            } else if (parse.receiveName == \"在线群聊\" && this.receiveName == parse.receiveName) {\r\n                this.message.push(parse)\r\n                let messageList = [];\r\n                let chatData = store.get(\"在线群聊\")\r\n                if (chatData != null) {\r\n                    messageList = chatData.message;\r\n                    messageList.push(parse)\r\n                }\r\n                store.set(\"在线群聊\", {message: messageList});\r\n                this.$nextTick(function (){\r\n                    let elementById = document.getElementById(\"scrollIV\");\r\n                    elementById.scrollTop = elementById.scrollHeight;\r\n                })\r\n                return;\r\n            } else if (parse.receiveName == \"在线群聊\" && this.receiveName != parse.receiveName) {\r\n                let chatData = store.get(\"在线群聊\")\r\n                let messageList = [];\r\n                if (chatData != null) {\r\n                    messageList = chatData.message;\r\n                    messageList.push(parse)\r\n                }\r\n                store.set(\"在线群聊\", {message: messageList});\r\n                this.nextTick()\r\n                return;\r\n            }\r\n            this.$nextTick(function (){\r\n                let elementById = document.getElementById(\"scrollIV\");\r\n                elementById.scrollTop = elementById.scrollHeight;\r\n            })\r\n            let sendName = parse.sendName;\r\n            if (this.sendName == sendName) return;\r\n            let messageList = [];\r\n            let chat = store.get(sendName);\r\n            if (chat != null) {\r\n                messageList = chat.message;\r\n                messageList.push(parse)\r\n            }\r\n            store.set(sendName, {message: messageList});\r\n\r\n        },\r\n        send() {\r\n            if (this.sendName == \"\" || this.sendName == null) {\r\n                alert(\"请设置昵称\")\r\n                this.sendName = prompt(\"昵称：\");\r\n                if (this.sendName == \"在线群聊\") return;\r\n                $.cookie(\"sendName\", this.sendName, {expires: 7, path: \"/\"})\r\n                let json = JSON.stringify({sendName: this.sendName, type: \"setting\"});\r\n                this.socket.send(json)\r\n            } else if (this.text == null || this.text == \"\") {\r\n                return;\r\n            } else if (this.receiveName == \"\") {\r\n                alert(\"请指定发送人\")\r\n            } else if (this.text.length < 0) {\r\n                return\r\n            } else {\r\n                let type = this.receiveName == \"在线群聊\" ? \"sendMessageAll\" : this.receiveName == \"机器人\" ? \"sendRobot\" : \"sendMessage\";\r\n                console.log(this.receiveName == \"机器人\")\r\n                let createDate = this.time.elapseTime() > 5 * 60 * 1000 ? this.time.reset() : null;\r\n                console.log(createDate);\r\n                let json = JSON.stringify({\r\n                    text: this.text,\r\n                    type: type,\r\n                    receiveName: this.receiveName,\r\n                    sendName: this.sendName,\r\n                    url: this.url,\r\n                    createDate: createDate ? createDate.format(\"yyyy-M-d h:m:s\") : null\r\n                })\r\n                this.socket.send(json)\r\n                this.text = \"\"\r\n                if (this.receiveName != \"在线群聊\") {\r\n                    this.message.push(JSON.parse(json))\r\n                }\r\n                console.log(json)\r\n                store.set(this.receiveName, {message: this.message});\r\n                document.getElementById(\"send\").innerHTML = \"\";\r\n                this.$nextTick(function (){\r\n                    let elementById = document.getElementById(\"scrollIV\");\r\n                    elementById.scrollTop = elementById.scrollHeight;\r\n                })\r\n            }\r\n        },\r\n        close() {\r\n            console.log(\"socket连接关闭\")\r\n        },\r\n        onAcquireName: function (name) {\r\n            this.userListOpen = false;\r\n            this.receiveName = name\r\n            this.message = []\r\n            let chat = store.get(this.receiveName);\r\n            if (chat != null) {\r\n                this.message = store.get(this.receiveName).message;\r\n            } else {\r\n                store.set(this.receiveName, {message: this.message})\r\n            }\r\n            this.$nextTick(function (){\r\n                let elementById = document.getElementById(\"scrollIV\");\r\n                elementById.scrollTop = elementById.scrollHeight;\r\n            })\r\n        },\r\n        chooseImg(file) {\r\n            console.log(this.sendName);\r\n            if (file != null && this.sendName != null) {\r\n                document.forms['upload'].submit()\r\n            }\r\n        },\r\n        edit(event) {\r\n            this.text = event.target.innerHTML;\r\n        }\r\n    },\r\n    destroyed() {\r\n        // 销毁监听\r\n        this.socket.onclose = this.close\r\n    },\r\n    computed: {\r\n        searchList: function () {\r\n            return this.userCount.filter((text) => {\r\n                return text.name.toLowerCase().match(this.searchVal.toLowerCase());\r\n            })\r\n        }\r\n    }\r\n})
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- src/main/resources/static/dist/js/index.js	(revision ac973f4ad6b6f8d8629ede07b943e524aeb1864e)
+++ src/main/resources/static/dist/js/index.js	(date 1607400199549)
@@ -200,7 +200,7 @@
     computed: {
         searchList: function () {
             return this.userCount.filter((text) => {
-                return text.name.toLowerCase().match(this.searchVal.toLowerCase());
+                return text.name.toLowerCase().match(this.searchVal.toLowerCase()) ;
             })
         }
     }
